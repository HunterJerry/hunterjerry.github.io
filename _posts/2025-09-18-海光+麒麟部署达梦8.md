---
layout:     post
title:      海光+麒麟部署达梦
subtitle:   让代码起飞
date:       2025-10-18
author:     WJ
header-img: img/post-bg-2015.jpg
catalog: true
tags:
    - 国产化
    - 海光芯片
    - 麒麟V10
    - 达梦数据库
---



## 环境准备

![麒麟海光（Kylin V10 SP2）系统安装达梦数据库_达梦数据库](https://s2.51cto.com/images/blog/front/202412/b92138004a817d0685c252f91463979b1276fc.png?x-oss-process=image/watermark,size_14,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=,x-oss-process=image/resize,m_fixed,w_1184/format,webp)

1. 达梦数据库下载地址：https://eco.dameng.com/download/
2. 服务端：dm8_20241226_HG_kylin10_64.zip
3. windows客户端：dm8_20241226_x86_win_64.zip

![麒麟海光（Kylin V10 SP2）系统安装达梦数据库_达梦数据库_02](https://s2.51cto.com/images/blog/front/202501/16aeb8f56ad4607e5f77498373c6ff9ccf6ebb.png?x-oss-process=image/watermark,size_14,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=,x-oss-process=image/resize,m_fixed,w_1184/format,webp)

### 一、系统环境配置

```
systemctl stop firewalld
systemctl disable firewalld
sed -i 's/enforcing/disabled/' /etc/selinux/config
setenforce 0
groupadd dinstall
useradd  -g dinstall -m -d /home/dmdba -s /bin/bash dmdba
passwd dmdba          #设置dmdba用户的密码

vim /etc/security/limits.conf
在最后添加参数
dmdba  soft      fsize      unlimited
dmdba  hard      fsize      unlimited
dmdba  soft      nproc      131072
dmdba  hard      nproc      131072
dmdba  soft      nofile      131072
dmdba  hard      nofile      131072
dmdba  soft      core      unlimited
dmdba  hard      core      unlimited
dmdba  soft      data      unlimited
dmdba  hard      data      unlimited

vim /etc/sysctl.conf
vm.overcommit_memory=0     #修改

sysctl -p       #使配置生效
-----------------------设置交换分区--------------------
dd if=/dev/zero of=/etc/swap bs=1M count=4096
chmod 600 /etc/swap
mkswap /etc/swap             #格式化为交换分区文件
swapon /etc/swap              #启用交换分区

vim /etc/fstab          #配置开机自动挂载
/etc/swap  swap       swap   defaults 0 0
```



### 二、安装数据库

1. #### 安装包解压和授权

```    
cd /home/dmdba/
unzip dm8_20241226_HG_kylin10_64.zip 
mkdir setup
mount -o loop dm8_20241226_HG_kylin10_64.iso ./setup/
cp -r ./setup/* /home/dmdba/
chown -R dmdba:dinstall DMInstall.bin
```

2. #### 安装数据库

```
su - dmdba
$ ./DMInstall.bin -i
安装语言: 
[1]: 简体中文
[2]: English
请选择安装语言 [1]:1
解压安装程序......... 
硬件架构校验通过！
欢迎使用达梦数据库安装程序

是否输入Key文件路径? (Y/y:是 N/n:否) [Y/y]:n

是否设置时区? (Y/y:是 N/n:否) [Y/y]:y
设置时区:
[ 1]: (GTM-12:00) 日界线西
[ 2]: (GTM-11:00) 萨摩亚群岛
[ 3]: (GTM-10:00) 夏威夷
[ 4]: (GTM-09:00) 阿拉斯加
[ 5]: (GTM-08:00) 太平洋时间（美国和加拿大）
[ 6]: (GTM-07:00) 亚利桑那
[ 7]: (GTM-06:00) 中部时间（美国和加拿大）
[ 8]: (GTM-05:00) 东部部时间（美国和加拿大）
[ 9]: (GTM-04:00) 大西洋时间（美国和加拿大）
[10]: (GTM-03:00) 巴西利亚
[11]: (GTM-02:00) 中大西洋
[12]: (GTM-01:00) 亚速尔群岛
[13]: (GTM) 格林威治标准时间
[14]: (GTM+01:00) 萨拉热窝
[15]: (GTM+02:00) 开罗
[16]: (GTM+03:00) 莫斯科
[17]: (GTM+04:00) 阿布扎比
[18]: (GTM+05:00) 伊斯兰堡
[19]: (GTM+06:00) 达卡
[20]: (GTM+07:00) 曼谷，河内
[21]: (GTM+08:00) 中国标准时间
[22]: (GTM+09:00) 首尔
[23]: (GTM+10:00) 关岛
[24]: (GTM+11:00) 所罗门群岛
[25]: (GTM+12:00) 斐济
[26]: (GTM+13:00) 努库阿勒法
[27]: (GTM+14:00) 基里巴斯
请选择时区 [21]:21

安装类型:
1 典型安装
2 服务器
3 客户端
4 自定义
请选择安装类型的数字序号 [1 典型安装]:1
所需空间: 2180M

请选择安装目录 [/home/dmdba/dmdbms]:
可用空间: 2G
是否确认安装路径(/home/dmdba/dmdbms)? (Y/y:是 N/n:否)  [Y/y]:y

安装前小结
安装位置: /home/dmdba/dmdbms
所需空间: 2180M
可用空间: 2G
版本信息: 
有效日期: 
安装类型: 典型安装
是否确认安装? (Y/y:是 N/n:否):y
2025-01-09 16:22:00 
[INFO] 安装达梦数据库...
2025-01-09 16:22:00 
[INFO] 安装 基础 模块...
2025-01-09 16:22:47 
[INFO] 安装 服务器 模块...
2025-01-09 16:22:54 
[INFO] 安装 客户端 模块...
2025-01-09 16:23:06 
[INFO] 安装 驱动 模块...
2025-01-09 16:23:11 
[INFO] 安装 手册 模块...
2025-01-09 16:23:14 
[INFO] 安装 服务 模块...
2025-01-09 16:23:15 
[INFO] 移动日志文件。
2025-01-09 16:23:16 
[INFO] 安装达梦数据库完成。

安装结束
```

以root执行：

```
/home/dmdba/dmdbms/script/root/root_installer.sh
```

![麒麟海光（Kylin V10 SP2）系统安装达梦数据库_达梦数据库_03](https://s2.51cto.com/images/blog/front/202501/945b86a06856ad313db892908a1edf6ee9fafe.png?x-oss-process=image/watermark,size_14,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=,x-oss-process=image/resize,m_fixed,w_1184/format,webp)

3. #### 设置环境变量

```
su - dmdba

$ vim .bash_profile
export LD_LIBRARY_PATH="$LD_LIBRARY_PATH:/home/dmdba/dmdbms/bin"
export DM_HOME="/home/dmdba/dmdbms"
export PATH=$PATH:$DM_HOME/bin:$DM_HOME/tool

$ source .bash_profile
```



4. #### 数据库初始化实例

```
mkdir /data
chown -R dmdba:dinstall /data/
su - dmdba
$ dminit path=/data PAGE_SIZE=16 CHARSET=1 BLANK_PAD_MODE=1 DB_NAME=DAMENG SYSDBA_PWD=Password123! SYSAUDITOR_PWD=Password123!
#这里要求必须设置 SYSDBA_PWD=和 SYSAUDITOR_PWD= ，，之前老版本没要求，不设置不能通过。
参数说明：
PATH：初始数据库存放的路径
EXTENT_SIZE：数据文件使用的簇大小，即每次分配新的段空间时连续的页数。取值：16、32、64。单位：页数。缺省值 16。
PAGE_SIZE：数据文件使用的页大小。取值：8、16、32，单位：K。默认值为 8。
LOG_SIZE：重做日志文件大小。取值：64 位版本时，取值为 256 和 8192 之间的整数，单位 MB。
CASE_SENSITIVE：标识符大小写敏感。建议从 MYSQL 和 SQLSERVER 迁移过来的系统，使用大小写不敏感，ORACLE 迁移过来的系统，使用大小写敏感，以便和原来系统匹配。
CHARSET/UNICODE_FLAG：字符集选项。取值：0 代表 GB18030，1 代表 UTF-8，2 代表韩文字符集 EUC-KR。默认为 0。
DB_NAME：初始化数据库名称，默认为 DAMENG。
INSTANCE_NAME：初始化数据库实例名称，默认为 DMSERVER。
PORT_NUM：初始化时设置 dm.ini 中的监听端口号，默认 5236 。
BLANK_PAD_MODE：设置字符串比较时，结尾空格填充模式是否兼容 ORACLE。1：兼容；0：不兼容。
PAGE_CHECK：PAGE_CHECK 为页检查模式。
```

![麒麟海光（Kylin V10 SP2）系统安装达梦数据库_麒麟系统_04](https://s2.51cto.com/images/blog/front/202501/96934b48682cfc10d697917c6a2ea4a70178ff.png?x-oss-process=image/watermark,size_14,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=,x-oss-process=image/resize,m_fixed,w_1184/format,webp)

5. #### 注册服务为系统服务

```
cd /home/dmdba/dmdbms/script/root/
./dm_service_installer.sh -t dmserver -p DMSERVER -dm_ini /data/DAMENG/dm.ini 

systemctl start DmServiceDMSERVER      #启动服务
systemctl stop DmServiceDMSERVER       #停止服务
```

![麒麟海光（Kylin V10 SP2）系统安装达梦数据库_达梦数据库_05](https://s2.51cto.com/images/blog/front/202501/37825742515b520bbba2695a3f7693138d79df.png?x-oss-process=image/watermark,size_14,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=,x-oss-process=image/resize,m_fixed,w_1184/format,webp)

### 三、链接测试

1. 服务器上连接

```
[root@localhost ~]# su - dmdba
[dmdba@localhost ~]$ disql
disql V8
用户名:SYSDBA
密码:

服务器[LOCALHOST:5236]:处于普通打开状态
登录使用时间 : 11.365(ms)
SQL>
```

2. windows客户端连接测试

![麒麟海光（Kylin V10 SP2）系统安装达梦数据库_达梦数据库_06](https://s2.51cto.com/images/blog/front/202501/7494588633a6947a26b074b20f13fd97bf9f44.png?x-oss-process=image/watermark,size_14,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=,x-oss-process=image/resize,m_fixed,w_1184/format,webp)

![麒麟海光（Kylin V10 SP2）系统安装达梦数据库_达梦数据库_07](https://s2.51cto.com/images/blog/front/202501/49981a6304b7130c4f12376db4f48219c64de0.png?x-oss-process=image/watermark,size_14,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=,x-oss-process=image/resize,m_fixed,w_1184/format,webp)

![麒麟海光（Kylin V10 SP2）系统安装达梦数据库_数据库_08](https://s2.51cto.com/images/blog/front/202501/571c8f34541adc1788c3215e5284caa42ad156.png?x-oss-process=image/watermark,size_14,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=,x-oss-process=image/resize,m_fixed,w_1184/format,webp)

![麒麟海光（Kylin V10 SP2）系统安装达梦数据库_达梦数据库_09](https://s2.51cto.com/images/blog/front/202501/4801d0715b8a0e7b572205726225fa95b1e104.png?x-oss-process=image/watermark,size_14,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=,x-oss-process=image/resize,m_fixed,w_1184/format,webp)![麒麟海光（Kylin V10 SP2）系统安装达梦数据库_达梦数据库_10](https://s2.51cto.com/images/blog/front/202501/b29862228b17eda7e1a58440100b8c6cb849be.png?x-oss-process=image/watermark,size_14,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_30,g_se,x_10,y_10,shadow_20,type_ZmFuZ3poZW5naGVpdGk=,x-oss-process=image/resize,m_fixed,w_1184/format,webp)



### 四、常用命令

```
--查询当前所有会话数
select count(*) from v$sessions;
--查看当前数据库中活动会话
select count(*) from v$sessions where state='ACTIVE';
--查看当前空闲会话
select count(*) from v$sessions where state='IDLE';

--产品授权信息检查
select * from v$license;
--归档状态检查
Select * from v$dm_ini where para_name=‘XXXX’;
--数据库会话情况检查
select user_name,state,clnt_ip,count(*) from v$sessions group by user_name,state,clnt_ip;
--锁定用户检查
select * from dba_users where account_status ='LOCKED';
--死锁历史检查
select * from v$deadlock_history;
--错误码
select * from v$err_info
--获取系统中最慢的 SQL 语句
SELECT * FROM V$LONG_EXEC_SQLS;或者 SELECT * FROM V$SYSTEM_LONG_EXEC_SQLS;

--查询所有用户
SELECT USERNAME FROM DBA_USERS;
--查询数据库名
select name,create_time from v$database;
--查看最大连接数
select SF_GET_PARA_VALUE(2,'MAX_SESSIONS');
--查询大小写是否敏感
SELECT CASE_SENSITIVE();
--查询达梦数据库当前状态
select status$ from v$instance;
--查询达梦数据库授权截至有效期
select EXPIRED_DATE FROM V$LICENSE;
--查看数据库版本
SELECT * FROM V$VERSION;
--查看所有schema
SELECT  * FROM DBA_OBJECTS WHERE OBJECT_TYPE='SCH';
```

